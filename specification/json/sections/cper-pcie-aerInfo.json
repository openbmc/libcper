{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "title": "PCIe Capability Structure",
    "type": "object",
    "description": "PCIe Advanced Error Reporting Extended Capability Structure",
    "additionalProperties": false,
    "properties": {
        "advanced_error_capabilities_and_control": {
            "type": "object",
            "properties": {
                "first_error_pointer": {
                    "type": "number"
                },
                "header_log_size": {
                    "type": "number"
                },
                "logged_tlp_size": {
                    "type": "number"
                }
            },
            "required": [
                "first_error_pointer",
                "header_log_size",
                "logged_tlp_size"
            ]
        },
        "capability_header": {
            "type": "object",
            "properties": {
                "capability_id": {
                    "type": "number"
                },
                "capability_version": {
                    "type": "number"
                },
                "next_capability_offset": {
                    "type": "number"
                }
            },
            "required": [
                "capability_id",
                "capability_version",
                "next_capability_offset"
            ]
        },
        "correctable_error_mask": {
            "type": "object",
            "properties": {
                "advisory_non_fatal_error_mask": {
                    "type": "number"
                },
                "bad_dllp_mask": {
                    "type": "number"
                },
                "bad_tlp_mask": {
                    "type": "number"
                },
                "corrected_internal_error_mask": {
                    "type": "number"
                },
                "header_log_overflow_mask": {
                    "type": "number"
                },
                "receiver_error_mask": {
                    "type": "number"
                },
                "replay_num_rollover_mask": {
                    "type": "number"
                },
                "replay_timer_timeout_mask": {
                    "type": "number"
                }
            },
            "required": [
                "advisory_non_fatal_error_mask",
                "bad_dllp_mask",
                "bad_tlp_mask",
                "corrected_internal_error_mask",
                "header_log_overflow_mask",
                "receiver_error_mask",
                "replay_num_rollover_mask",
                "replay_timer_timeout_mask"
            ]
        },
        "correctable_error_status": {
            "type": "object",
            "properties": {
                "advisory_non_fatal_error_status": {
                    "type": "boolean"
                },
                "bad_dllp_status": {
                    "type": "boolean"
                },
                "bad_tlp_status": {
                    "type": "boolean"
                },
                "corrected_internal_error_status": {
                    "type": "boolean"
                },
                "header_log_overflow_status": {
                    "type": "boolean"
                },
                "receiver_error_status": {
                    "type": "boolean"
                },
                "replay_num_rollover_status": {
                    "type": "boolean"
                },
                "replay_timer_timeout_status": {
                    "type": "boolean"
                }
            },
            "required": [
                "advisory_non_fatal_error_status",
                "bad_dllp_status",
                "bad_tlp_status",
                "corrected_internal_error_status",
                "header_log_overflow_status",
                "receiver_error_status",
                "replay_num_rollover_status",
                "replay_timer_timeout_status"
            ]
        },
        "data": {
            "type": "string"
        },
        "error_source_id": {
            "type": "object",
            "properties": {
                "err_cor_source_identification": {
                    "type": "number"
                },
                "err_fatal_nonfatal_source_identification": {
                    "type": "number"
                }
            },
            "required": [
                "err_cor_source_identification",
                "err_fatal_nonfatal_source_identification"
            ]
        },
        "root_error_command": {
            "type": "object",
            "properties": {},
            "required": []
        },
        "root_error_status": {
            "type": "object",
            "properties": {
                "advanced_error_interrupt_message_number": {
                    "type": "number"
                },
                "err_cor_subclass": {
                    "type": "number"
                }
            },
            "required": [
                "advanced_error_interrupt_message_number",
                "err_cor_subclass"
            ]
        },
        "uncorrectable_error_mask": {
            "type": "object",
            "properties": {
                "acs_violation_mask": {
                    "type": "number"
                },
                "atomicop_egress_blocked_mask": {
                    "type": "number"
                },
                "completer_abort_mask": {
                    "type": "number"
                },
                "completion_timeout_mask": {
                    "type": "number"
                },
                "data_link_protocol_error_mask": {
                    "type": "number"
                },
                "dmwr_request_egress_blocked_mask": {
                    "type": "number"
                },
                "ecrc_error_mask": {
                    "type": "number"
                },
                "flow_control_protocol_error_mask": {
                    "type": "number"
                },
                "ide_check_failed_mask": {
                    "type": "number"
                },
                "malformed_tlp_mask": {
                    "type": "number"
                },
                "mc_blocked_tlp_mask": {
                    "type": "number"
                },
                "misrouted_ide_tlp_mask": {
                    "type": "number"
                },
                "pcrc_check_failed_mask": {
                    "type": "number"
                },
                "poisoned_tlp_egress_blocked_mask": {
                    "type": "number"
                },
                "poisoned_tlp_received_mask": {
                    "type": "number"
                },
                "receiver_overflow_mask": {
                    "type": "number"
                },
                "surprise_down_error_mask": {
                    "type": "number"
                },
                "tlp_prefix_blocked_error_mask": {
                    "type": "number"
                },
                "tlp_translation_egress_blocked_mask": {
                    "type": "number"
                },
                "uncorrectable_internal_error_mask": {
                    "type": "number"
                },
                "unexpected_completion_mask": {
                    "type": "number"
                },
                "unsupported_request_error_mask": {
                    "type": "number"
                }
            },
            "required": [
                "acs_violation_mask",
                "atomicop_egress_blocked_mask",
                "completer_abort_mask",
                "completion_timeout_mask",
                "data_link_protocol_error_mask",
                "dmwr_request_egress_blocked_mask",
                "ecrc_error_mask",
                "flow_control_protocol_error_mask",
                "ide_check_failed_mask",
                "malformed_tlp_mask",
                "mc_blocked_tlp_mask",
                "misrouted_ide_tlp_mask",
                "pcrc_check_failed_mask",
                "poisoned_tlp_egress_blocked_mask",
                "poisoned_tlp_received_mask",
                "receiver_overflow_mask",
                "surprise_down_error_mask",
                "tlp_prefix_blocked_error_mask",
                "tlp_translation_egress_blocked_mask",
                "uncorrectable_internal_error_mask",
                "unexpected_completion_mask",
                "unsupported_request_error_mask"
            ]
        },
        "uncorrectable_error_severity": {
            "type": "object",
            "properties": {
                "acs_violation_severity": {
                    "type": "string"
                },
                "atomicop_egress_blocked_severity": {
                    "type": "string"
                },
                "completer_abort_severity": {
                    "type": "string"
                },
                "completion_timeout_severity": {
                    "type": "string"
                },
                "data_link_protocol_error_severity": {
                    "type": "string"
                },
                "dmwr_request_egress_blocked_severity": {
                    "type": "string"
                },
                "ecrc_error_severity": {
                    "type": "string"
                },
                "flow_control_protocol_error_severity": {
                    "type": "string"
                },
                "ide_check_failed_severity": {
                    "type": "string"
                },
                "malformed_tlp_severity": {
                    "type": "string"
                },
                "mc_blocked_tlp_severity": {
                    "type": "string"
                },
                "misrouted_ide_tlp_severity": {
                    "type": "string"
                },
                "pcrc_check_failed_severity": {
                    "type": "string"
                },
                "poisoned_tlp_egress_blocked_severity": {
                    "type": "string"
                },
                "poisoned_tlp_received_severity": {
                    "type": "string"
                },
                "receiver_overflow_severity": {
                    "type": "string"
                },
                "surprise_down_error_severity": {
                    "type": "string"
                },
                "tlp_prefix_blocked_error_severity": {
                    "type": "string"
                },
                "tlp_translation_egress_blocked_severity": {
                    "type": "string"
                },
                "uncorrectable_internal_error_severity": {
                    "type": "string"
                },
                "unexpected_completion_severity": {
                    "type": "string"
                },
                "unsupported_request_error_severity": {
                    "type": "string"
                }
            },
            "required": [
                "acs_violation_severity",
                "atomicop_egress_blocked_severity",
                "completer_abort_severity",
                "completion_timeout_severity",
                "data_link_protocol_error_severity",
                "dmwr_request_egress_blocked_severity",
                "ecrc_error_severity",
                "flow_control_protocol_error_severity",
                "ide_check_failed_severity",
                "malformed_tlp_severity",
                "mc_blocked_tlp_severity",
                "misrouted_ide_tlp_severity",
                "pcrc_check_failed_severity",
                "poisoned_tlp_egress_blocked_severity",
                "poisoned_tlp_received_severity",
                "receiver_overflow_severity",
                "surprise_down_error_severity",
                "tlp_prefix_blocked_error_severity",
                "tlp_translation_egress_blocked_severity",
                "uncorrectable_internal_error_severity",
                "unexpected_completion_severity",
                "unsupported_request_error_severity"
            ]
        },
        "uncorrectable_error_status": {
            "type": "object",
            "properties": {
                "acs_violation_status": {
                    "type": "boolean"
                },
                "atomicop_egress_blocked_status": {
                    "type": "boolean"
                },
                "completer_abort_status": {
                    "type": "boolean"
                },
                "completion_timeout_status": {
                    "type": "boolean"
                },
                "data_link_protocol_error_status": {
                    "type": "boolean"
                },
                "dmwr_request_egress_blocked_status": {
                    "type": "boolean"
                },
                "ecrc_error_status": {
                    "type": "boolean"
                },
                "flow_control_protocol_error_status": {
                    "type": "boolean"
                },
                "ide_check_failed_status": {
                    "type": "boolean"
                },
                "malformed_tlp_status": {
                    "type": "boolean"
                },
                "mc_blocked_tlp_status": {
                    "type": "boolean"
                },
                "misrouted_ide_tlp_status": {
                    "type": "boolean"
                },
                "pcrc_check_failed_status": {
                    "type": "boolean"
                },
                "poisoned_tlp_egress_blocked_status": {
                    "type": "boolean"
                },
                "poisoned_tlp_received": {
                    "type": "boolean"
                },
                "receiver_overflow_status": {
                    "type": "boolean"
                },
                "surprise_down_error_status": {
                    "type": "boolean"
                },
                "tlp_prefix_blocked_error_status": {
                    "type": "boolean"
                },
                "tlp_translation_egress_blocked_status": {
                    "type": "boolean"
                },
                "uncorrectable_internal_error_status": {
                    "type": "boolean"
                },
                "unexpected_completion_status": {
                    "type": "boolean"
                },
                "unsupported_request_error_status": {
                    "type": "boolean"
                }
            },
            "required": [
                "acs_violation_status",
                "atomicop_egress_blocked_status",
                "completer_abort_status",
                "completion_timeout_status",
                "data_link_protocol_error_status",
                "dmwr_request_egress_blocked_status",
                "ecrc_error_status",
                "flow_control_protocol_error_status",
                "ide_check_failed_status",
                "malformed_tlp_status",
                "mc_blocked_tlp_status",
                "misrouted_ide_tlp_status",
                "pcrc_check_failed_status",
                "poisoned_tlp_egress_blocked_status",
                "poisoned_tlp_received",
                "receiver_overflow_status",
                "surprise_down_error_status",
                "tlp_prefix_blocked_error_status",
                "tlp_translation_egress_blocked_status",
                "uncorrectable_internal_error_status",
                "unexpected_completion_status",
                "unsupported_request_error_status"
            ]
        }
    },
    "required": [
        "advanced_error_capabilities_and_control",
        "capability_header",
        "correctable_error_mask",
        "correctable_error_status",
        "data",
        "error_source_id",
        "root_error_command",
        "root_error_status",
        "uncorrectable_error_mask",
        "uncorrectable_error_severity",
        "uncorrectable_error_status"
    ]
}
